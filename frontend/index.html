<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="ูุธุงู ุชูููุฏ ุงูุฌุฏุงูู ุงูุฏุฑุงุณูุฉ ุงูุฐูู - ุฃุฏุงุฉ ูุชูุงููุฉ ูุฅุฏุงุฑุฉ ุงูุฌุฏุงูู ุงููุฏุฑุณูุฉ">
  <title>๐ ูููุฏ ุงูุฌุฏูู ุงูุฏุฑุงุณู ุงูุฐูู</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link rel="stylesheet" href="css/styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <!-- Preload critical resources -->
  <link rel="preload" href="js/shared.js" as="script">
  <link rel="preload" href="js/app.js" as="script">
</head>
<body>
  <div class="loading-overlay hidden" id="globalLoader">
    <div class="loading-spinner"></div>
    <div class="loading-text">ุฌุงุฑ ุงูุชุญููู...</div>
  </div>

  <nav class="main-nav animate__animated animate__fadeIn" aria-label="ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ">
    <ul>
      <li><a href="index.html" class="active" aria-current="page">ุงูุฑุฆูุณูุฉ</a></li>
      <li><a href="settings.html">ุฅุนุฏุงุฏุงุช ุงููููุฉ</a></li>
      <li><a href="departments.html">ุฅุฏุงุฑุฉ ุงูุฃูุณุงู</a></li>
      <li><a href="add-teachers.html">ุฅุถุงูุฉ ูุฏุฑุณูู</a></li>
      <li><a href="students.html">ุฅุฏุงุฑุฉ ุงูุทูุงุจ</a></li>
      <li><a href="courses.html">ุฅุฏุงุฑุฉ ุงูููุงุฏ</a></li>
      <li><a href="rooms.html">ุฅุฏุงุฑุฉ ุงูุฃูุงูู</a></li>
      <li><a href="teachers.html">ุฅุฏุงุฑุฉ ุงููุฏุฑุณูู</a></li>
      <li><a href="generate.html">ุชูููุฏ ุงูุฌุฏูู</a></li>
      <li><a href="schedule.html">ุนุฑุถ ุงูุฌุฏูู</a></li>
    </ul>
  </nav>

  <main class="container animate__animated animate__fadeIn">
    <header>
      <h1 class="animate__animated animate__bounceIn">๐ ูุธุงู ุชูููุฏ ุงูุฌุฏุงูู ุงูุฏุฑุงุณูุฉ</h1>
      <p class="subtitle" id="collegeNameSubtitle">ูุธุงู ูุชูุงูู ูุฅุฏุงุฑุฉ ูุชูููุฏ ุงูุฌุฏุงูู ุงูุฏุฑุงุณูุฉ</p>
    </header>

    <section aria-labelledby="quick-actions-heading">
      <h2 id="quick-actions-heading" class="sr-only">ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ</h2>
      <div class="quick-actions">
        <a href="settings.html" class="quick-action-card animate-slide" aria-label="ุฅุนุฏุงุฏุงุช ุงููููุฉ">
          <div class="action-icon" aria-hidden="true">โ๏ธ</div>
          <h3>ุฅุนุฏุงุฏุงุช ุงููููุฉ</h3>
          <p>ุชุนุฏูู ุฃูุงู ุงูุฏุฑุงุณุฉ ูุงูุฃููุงุช</p>
        </a>
        
        <a href="rooms.html" class="quick-action-card animate-slide" style="animation-delay: 0.1s" aria-label="ุฅุฏุงุฑุฉ ุงููุงุนุงุช">
          <div class="action-icon" aria-hidden="true">๐ซ</div>
          <h3>ุฅุฏุงุฑุฉ ุงููุงุนุงุช</h3>
          <p>ุฅุถุงูุฉ/ุญุฐู ุงููุงุนุงุช ุงูุฏุฑุงุณูุฉ</p>
        </a>
        
        <a href="teachers.html" class="quick-action-card animate-slide" style="animation-delay: 0.2s" aria-label="ุฅุฏุงุฑุฉ ุงููุฏุฑุณูู">
          <div class="action-icon" aria-hidden="true">๐จโ๐ซ</div>
          <h3>ุฅุฏุงุฑุฉ ุงููุฏุฑุณูู</h3>
          <p>ุฅุถุงูุฉ ุงููุฏุฑุณูู ูุชูุงูุฑูู</p>
        </a>
        
        <a href="generate.html" class="quick-action-card animate-slide" style="animation-delay: 0.3s" aria-label="ุชูููุฏ ุงูุฌุฏูู">
          <div class="action-icon" aria-hidden="true">โจ</div>
          <h3>ุชูููุฏ ุงูุฌุฏูู</h3>
          <p>ุฅูุดุงุก ุฌุฏูู ุฏุฑุงุณู ุฌุฏูุฏ</p>
        </a>
        
        <a href="schedule.html" class="quick-action-card animate-slide" style="animation-delay: 0.4s" aria-label="ุนุฑุถ ุงูุฌุฏูู">
          <div class="action-icon" aria-hidden="true">๐</div>
          <h3>ุนุฑุถ ุงูุฌุฏูู</h3>
          <p>ุนุฑุถ ูุชุตุฏูุฑ ุงูุฌุฏูู ุงูููุงุฆู</p>
        </a>

        <a href="departments.html" class="quick-action-card animate-slide" style="animation-delay: 0.5s" aria-label="ุฅุฏุงุฑุฉ ุงูุฃูุณุงู">
          <div class="action-icon" aria-hidden="true">๐๏ธ</div>
          <h3>ุฅุฏุงุฑุฉ ุงูุฃูุณุงู</h3>
          <p>ุฅุถุงูุฉ ูุชุนุฏูู ุงูุฃูุณุงู</p>
        </a>
        
        <a href="#" class="quick-action-card animate-slide" style="animation-delay: 0.7s" aria-label="ุงูุชูุงุฑูุฑ" id="reportsBtn">
          <div class="action-icon" aria-hidden="true">๐</div>
          <h3>ุงูุชูุงุฑูุฑ</h3>
          <p>ุนุฑุถ ุชูุงุฑูุฑ ุงูุฌุฏูู</p>
        </a>
      </div>
    </section>

    <section aria-labelledby="stats-heading">
      <h2 id="stats-heading" class="sr-only">ุฅุญุตุงุฆูุงุช ุงููุธุงู</h2>
      <div class="stats-summary animate-slide" style="animation-delay: 0.5s">
        <div class="stat-card">
          <div class="stat-icon">๐จโ๐ซ</div>
          <h3>ุนุฏุฏ ุงููุฏุฑุณูู</h3>
          <p id="teachersCount" aria-live="polite">0</p>
        </div>
        <div class="stat-card">
          <div class="stat-icon">๐ซ</div>
          <h3>ุนุฏุฏ ุงููุงุนุงุช</h3>
          <p id="roomsCount" aria-live="polite">0</p>
        </div>
        <div class="stat-card">
          <div class="stat-icon">๐</div>
          <h3>ุนุฏุฏ ุงูููุงุฏ</h3>
          <p id="coursesCount" aria-live="polite">0</p>
        </div>
        <div class="stat-card">
          <div class="stat-icon">๐งโ๐</div>
          <h3>ุนุฏุฏ ุงูุทูุงุจ</h3>
          <p id="studentsCount" aria-live="polite">0</p>
        </div>
      </div>
    </section>

    <section class="recent-activity" aria-labelledby="recent-activity-heading">
      <h2 id="recent-activity-heading">ุขุฎุฑ ุงูุชุญุฏูุซุงุช</h2>
      <div id="activityFeed" class="activity-feed">
        <!-- Will be populated by JavaScript -->
      </div>
    </section>
  </main>

  <footer class="main-footer">
    <p>ูุธุงู ุชูููุฏ ุงูุฌุฏุงูู ุงูุฏุฑุงุณูุฉ &copy; <span id="currentYear"></span></p>
    <p>ุงูุฅุตุฏุงุฑ 2.0.0</p>
  </footer>

  <script src="js/shared.js" defer></script>
  <script src="js/app.js" defer></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Set current year in footer
      document.getElementById('currentYear').textContent = new Date().getFullYear();
      
      // Set college name if available
      if (SharedData.settings?.collegeName) {
        document.getElementById('collegeNameSubtitle').textContent = 
          `${SharedData.settings.collegeName} - ูุธุงู ูุชูุงูู ูุฅุฏุงุฑุฉ ุงูุฌุฏุงูู ุงูุฏุฑุงุณูุฉ`;
      }
      
      // Update stats
      document.getElementById('teachersCount').textContent = SharedData.teachers.length;
      document.getElementById('roomsCount').textContent = SharedData.rooms.length;
      document.getElementById('coursesCount').textContent = SharedData.courses.length;
      
      // Calculate total students
      const totalStudents = SharedData.studentYears?.reduce((total, year) => {
        return total + year.groups.reduce((sum, group) => sum + (group.students || 0), 0);
      }, 0) || 0;
      document.getElementById('studentsCount').textContent = totalStudents;
            
      // Hide loader
      document.getElementById('globalLoader').classList.add('hidden');
    });

    function updateActivityFeed() {
      const feed = document.getElementById('activityFeed');
      if (!feed) return;
      
      const activities = [];
      
      // Add last schedule generation if exists
      if (SharedData.schedule && SharedData.schedule.length > 0) {
        const lastGenerated = SharedData.lastScheduleGeneration || new Date().toISOString();
        activities.push({
          type: 'schedule',
          date: new Date(lastGenerated),
          count: SharedData.schedule.length
        });
      }
      
      // Add recent teachers added (last 3)
      if (SharedData.teachers.length > 0) {
        const sortedTeachers = [...SharedData.teachers]
          .sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0))
          .slice(0, 3);
        
        sortedTeachers.forEach(teacher => {
          activities.push({
            type: 'teacher',
            name: teacher.name,
            date: new Date(teacher.createdAt || Date.now()),
            subject: teacher.subject
          });
        });
      }
      
      // Add recent courses added (last 2)
      if (SharedData.courses.length > 0) {
        const sortedCourses = [...SharedData.courses]
          .sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0))
          .slice(0, 2);
        
        sortedCourses.forEach(course => {
          activities.push({
            type: 'course',
            name: course.name,
            date: new Date(course.createdAt || Date.now()),
            code: course.code
          });
        });
      }
      
      // Sort all activities by date (newest first)
      activities.sort((a, b) => b.date - a.date);
      
      // Render activities
      if (activities.length === 0) {
        feed.innerHTML = '<p class="empty-activity">ูุง ููุฌุฏ ูุดุงุท ุญุฏูุซ</p>';
        return;
      }
      
      feed.innerHTML = activities.map(activity => {
        const dateStr = activity.date.toLocaleDateString('ar-EG', {
          year: 'numeric',
          month: 'long',
          day: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        });
        
        if (activity.type === 'schedule') {
          return `
            <div class="activity-item schedule-activity">
              <span class="activity-icon">๐</span>
              <div class="activity-content">
                <p>ุชู ุชูููุฏ ุฌุฏูู ุฌุฏูุฏ ูุญุชูู ุนูู ${activity.count} ุญุตุฉ</p>
                <time datetime="${activity.date.toISOString()}">${dateStr}</time>
              </div>
            </div>
          `;
        } else if (activity.type === 'teacher') {
          return `
            <div class="activity-item teacher-activity">
              <span class="activity-icon">๐จโ๐ซ</span>
              <div class="activity-content">
                <p>ุชู ุฅุถุงูุฉ ุงููุฏุฑุณ <strong>${activity.name}</strong></p>
                <time datetime="${activity.date.toISOString()}">${dateStr}</time>
              </div>
            </div>
          `;
        } else if (activity.type === 'course') {
          return `
            <div class="activity-item course-activity">
              <span class="activity-icon">๐</span>
              <div class="activity-content">
                <p>ุชู ุฅุถุงูุฉ ุงููุงุฏุฉ <strong>${activity.name}</strong> (${activity.code})</p>
                <time datetime="${activity.date.toISOString()}">${dateStr}</time>
              </div>
            </div>
          `;
        }
      }).join('');
    }
  </script>
  <button class="theme-toggle" id="themeToggle" aria-label="ุชุจุฏูู ุงููุถุน ุงููููู">
    <i>๐</i>
  </button>

  <script>
    // Dark mode toggle functionality
    document.addEventListener('DOMContentLoaded', () => {
      const themeToggle = document.getElementById('themeToggle');
      const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
      
      // Check for saved theme preference or use system preference
      const currentTheme = localStorage.getItem('theme') || 
                          (prefersDarkScheme.matches ? 'dark' : 'light');
      
      // Apply the current theme
      if (currentTheme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
        themeToggle.innerHTML = '<i>โ๏ธ</i>';
      }
      
      // Toggle theme on button click
      themeToggle.addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        
        if (currentTheme === 'dark') {
          document.documentElement.removeAttribute('data-theme');
          localStorage.setItem('theme', 'light');
          themeToggle.innerHTML = '<i>๐</i>';
        } else {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
          themeToggle.innerHTML = '<i>โ๏ธ</i>';
        }
      });
    });
  </script>
</body>
</html>