<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Ù†Ø¸Ø§Ù… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© Ø§Ù„Ø°ÙƒÙŠ - Ø£Ø¯Ø§Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©">
  <title>ğŸ“˜ Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø°ÙƒÙŠ</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link rel="stylesheet" href="css/styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <!-- Preload critical resources -->
  <link rel="preload" href="js/shared.js" as="script">
  <link rel="preload" href="js/app.js" as="script">
</head>
<body>
  <div class="loading-overlay hidden" id="globalLoader">
    <div class="loading-spinner"></div>
    <div class="loading-text">Ø¬Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
  </div>

  <nav class="main-nav animate__animated animate__fadeIn" aria-label="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">
    <ul>
      <li><a href="index.html" class="active" aria-current="page">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
      <li><a href="settings.html">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ©</a></li>
      <li><a href="departments.html">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</a></li>
      <li><a href="add-teachers.html">Ø¥Ø¶Ø§ÙØ© Ù…Ø¯Ø±Ø³ÙŠÙ†</a></li>
      <li><a href="students.html">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</a></li>
      <li><a href="courses.html">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯</a></li>
      <li><a href="rooms.html">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù…Ø§ÙƒÙ†</a></li>
      <li><a href="teachers.html">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†</a></li>
      <li><a href="generate.html">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„</a></li>
      <li><a href="schedule.html">Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„</a></li>
    </ul>
  </nav>

  <main class="container animate__animated animate__fadeIn">
    <header>
      <h1 class="animate__animated animate__bounceIn">ğŸ“˜ Ù†Ø¸Ø§Ù… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h1>
      <p class="subtitle" id="collegeNameSubtitle">Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</p>
    </header>

    <section aria-labelledby="quick-actions-heading">
      <h2 id="quick-actions-heading" class="sr-only">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h2>
      <div class="quick-actions">
        <a href="settings.html" class="quick-action-card animate-slide" aria-label="Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ©">
          <div class="action-icon" aria-hidden="true">âš™ï¸</div>
          <h3>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ©</h3>
          <p>ØªØ¹Ø¯ÙŠÙ„ Ø£ÙŠØ§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³Ø© ÙˆØ§Ù„Ø£ÙˆÙ‚Ø§Øª</p>
        </a>
        
        <a href="rooms.html" class="quick-action-card animate-slide" style="animation-delay: 0.1s" aria-label="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¹Ø§Øª">
          <div class="action-icon" aria-hidden="true">ğŸ«</div>
          <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¹Ø§Øª</h3>
          <p>Ø¥Ø¶Ø§ÙØ©/Ø­Ø°Ù Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</p>
        </a>
        
        <a href="teachers.html" class="quick-action-card animate-slide" style="animation-delay: 0.2s" aria-label="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†">
          <div class="action-icon" aria-hidden="true">ğŸ‘¨â€ğŸ«</div>
          <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†</h3>
          <p>Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ† ÙˆØªÙˆØ§ÙØ±Ù‡Ù…</p>
        </a>
        
        <a href="generate.html" class="quick-action-card animate-slide" style="animation-delay: 0.3s" aria-label="ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„">
          <div class="action-icon" aria-hidden="true">âœ¨</div>
          <h3>ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„</h3>
          <p>Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø¯Ø±Ø§Ø³ÙŠ Ø¬Ø¯ÙŠØ¯</p>
        </a>
        
        <a href="schedule.html" class="quick-action-card animate-slide" style="animation-delay: 0.4s" aria-label="Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„">
          <div class="action-icon" aria-hidden="true">ğŸ“…</div>
          <h3>Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„</h3>
          <p>Ø¹Ø±Ø¶ ÙˆØªØµØ¯ÙŠØ± Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</p>
        </a>

        <a href="departments.html" class="quick-action-card animate-slide" style="animation-delay: 0.5s" aria-label="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…">
          <div class="action-icon" aria-hidden="true">ğŸ›ï¸</div>
          <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h3>
          <p>Ø¥Ø¶Ø§ÙØ© ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</p>
        </a>
        
        <a href="#" class="quick-action-card animate-slide" style="animation-delay: 0.7s" aria-label="Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±" id="reportsBtn">
          <div class="action-icon" aria-hidden="true">ğŸ“Š</div>
          <h3>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h3>
          <p>Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¬Ø¯ÙˆÙ„</p>
        </a>
      </div>
    </section>

    <section aria-labelledby="stats-heading">
      <h2 id="stats-heading" class="sr-only">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
      <div class="stats-summary animate-slide" style="animation-delay: 0.5s">
        <div class="stat-card">
          <div class="stat-icon">ğŸ‘¨â€ğŸ«</div>
          <h3>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†</h3>
          <p id="teachersCount" aria-live="polite">0</p>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ«</div>
          <h3>Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª</h3>
          <p id="roomsCount" aria-live="polite">0</p>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ“š</div>
          <h3>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯</h3>
          <p id="coursesCount" aria-live="polite">0</p>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ§‘â€ğŸ“</div>
          <h3>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨</h3>
          <p id="studentsCount" aria-live="polite">0</p>
        </div>
      </div>
    </section>

    <section class="recent-activity" aria-labelledby="recent-activity-heading">
      <h2 id="recent-activity-heading">Ø¢Ø®Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª</h2>
      <div id="activityFeed" class="activity-feed">
        <!-- Will be populated by JavaScript -->
      </div>
    </section>
  </main>

  <footer class="main-footer">
    <p>Ù†Ø¸Ø§Ù… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© &copy; <span id="currentYear"></span></p>
    <p>Ø§Ù„Ø¥ØµØ¯Ø§Ø± 2.0.0</p>
  </footer>

  <script src="js/shared.js" defer></script>
  <script src="js/app.js" defer></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Set current year in footer
      document.getElementById('currentYear').textContent = new Date().getFullYear();
      
      // Set college name if available
      if (SharedData.settings?.collegeName) {
        document.getElementById('collegeNameSubtitle').textContent = 
          `${SharedData.settings.collegeName} - Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©`;
      }
      
      // Update stats
      document.getElementById('teachersCount').textContent = SharedData.teachers.length;
      document.getElementById('roomsCount').textContent = SharedData.rooms.length;
      document.getElementById('coursesCount').textContent = SharedData.courses.length;
      
      // Calculate total students
      const totalStudents = SharedData.studentYears?.reduce((total, year) => {
        return total + year.groups.reduce((sum, group) => sum + (group.students || 0), 0);
      }, 0) || 0;
      document.getElementById('studentsCount').textContent = totalStudents;
            
      // Hide loader
      document.getElementById('globalLoader').classList.add('hidden');
    });

    function updateActivityFeed() {
      const feed = document.getElementById('activityFeed');
      if (!feed) return;
      
      const activities = [];
      
      // Add last schedule generation if exists
      if (SharedData.schedule && SharedData.schedule.length > 0) {
        const lastGenerated = SharedData.lastScheduleGeneration || new Date().toISOString();
        activities.push({
          type: 'schedule',
          date: new Date(lastGenerated),
          count: SharedData.schedule.length
        });
      }
      
      // Add recent teachers added (last 3)
      if (SharedData.teachers.length > 0) {
        const sortedTeachers = [...SharedData.teachers]
          .sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0))
          .slice(0, 3);
        
        sortedTeachers.forEach(teacher => {
          activities.push({
            type: 'teacher',
            name: teacher.name,
            date: new Date(teacher.createdAt || Date.now()),
            subject: teacher.subject
          });
        });
      }
      
      // Add recent courses added (last 2)
      if (SharedData.courses.length > 0) {
        const sortedCourses = [...SharedData.courses]
          .sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0))
          .slice(0, 2);
        
        sortedCourses.forEach(course => {
          activities.push({
            type: 'course',
            name: course.name,
            date: new Date(course.createdAt || Date.now()),
            code: course.code
          });
        });
      }
      
      // Sort all activities by date (newest first)
      activities.sort((a, b) => b.date - a.date);
      
      // Render activities
      if (activities.length === 0) {
        feed.innerHTML = '<p class="empty-activity">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø· Ø­Ø¯ÙŠØ«</p>';
        return;
      }
      
      feed.innerHTML = activities.map(activity => {
        const dateStr = activity.date.toLocaleDateString('ar-EG', {
          year: 'numeric',
          month: 'long',
          day: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        });
        
        if (activity.type === 'schedule') {
          return `
            <div class="activity-item schedule-activity">
              <span class="activity-icon">ğŸ“…</span>
              <div class="activity-content">
                <p>ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø¬Ø¯ÙˆÙ„ Ø¬Ø¯ÙŠØ¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ${activity.count} Ø­ØµØ©</p>
                <time datetime="${activity.date.toISOString()}">${dateStr}</time>
              </div>
            </div>
          `;
        } else if (activity.type === 'teacher') {
          return `
            <div class="activity-item teacher-activity">
              <span class="activity-icon">ğŸ‘¨â€ğŸ«</span>
              <div class="activity-content">
                <p>ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¯Ø±Ø³ <strong>${activity.name}</strong></p>
                <time datetime="${activity.date.toISOString()}">${dateStr}</time>
              </div>
            </div>
          `;
        } else if (activity.type === 'course') {
          return `
            <div class="activity-item course-activity">
              <span class="activity-icon">ğŸ“š</span>
              <div class="activity-content">
                <p>ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø§Ø¯Ø© <strong>${activity.name}</strong> (${activity.code})</p>
                <time datetime="${activity.date.toISOString()}">${dateStr}</time>
              </div>
            </div>
          `;
        }
      }).join('');
    }
  </script>
  <button class="theme-toggle" id="themeToggle" aria-label="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ">
    <i>ğŸŒ™</i>
  </button>

  <script>
    // Dark mode toggle functionality
    document.addEventListener('DOMContentLoaded', () => {
      const themeToggle = document.getElementById('themeToggle');
      const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
      
      // Check for saved theme preference or use system preference
      const currentTheme = localStorage.getItem('theme') || 
                          (prefersDarkScheme.matches ? 'dark' : 'light');
      
      // Apply the current theme
      if (currentTheme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
        themeToggle.innerHTML = '<i>â˜€ï¸</i>';
      }
      
      // Toggle theme on button click
      themeToggle.addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        
        if (currentTheme === 'dark') {
          document.documentElement.removeAttribute('data-theme');
          localStorage.setItem('theme', 'light');
          themeToggle.innerHTML = '<i>ğŸŒ™</i>';
        } else {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
          themeToggle.innerHTML = '<i>â˜€ï¸</i>';
        }
      });
    });
  </script>
</body>
</html>